<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>é«˜æ ¡ç”Ÿå‘ã‘ãƒ»ãƒãƒƒã‚­ãƒ³ã‚°ä½“é¨“ãƒ©ãƒœï¼ˆå­¦ç¿’ç”¨ï¼‰</title>
<style>
  :root{
    --bg:#0f1222;--card:#151a2f;--ink:#eef1ff;--sub:#a9add6;--ok:#1dd18c;--warn:#ffb02e;--bad:#ff5f7a;--acc:#7aa2ff
  }
  *{box-sizing:border-box}
  body{margin:0;background:linear-gradient(180deg,#0d1020,#0e1530 45%,#0b1020);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans JP",sans-serif}
  header{padding:28px 16px;text-align:center;border-bottom:1px solid #243055}
  header h1{margin:0 0 6px;font-size:28px}
  header p{margin:0;color:var(--sub)}
  main{max-width:1100px;margin:20px auto;padding:0 14px;display:grid;gap:12px}
  .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  input,select,textarea,button{border-radius:12px;border:1px solid #2a355d;background:#0f1430;color:var(--ink)}
  input,select,button{padding:10px 12px}
  textarea{padding:10px 12px;min-height:90px;width:100%}
  button{cursor:pointer;font-weight:600}
  .btn{background:#1b2a62;border-color:#27428f}
  .btn-ghost{background:transparent}
  .btn-good{background:#183022;border-color:#245c3f}
  .btn-bad{background:#2a1520;border-color:#4b293b}
  .pill{display:inline-flex;align-items:center;gap:6px;border:1px solid #2a355d;padding:2px 8px;border-radius:999px}
  .ok{color:var(--ok)} .bad{color:var(--bad)} .sub{color:var(--sub)}
  .card{background:var(--card);border:1px solid #223059;border-radius:16px;overflow:hidden}
  .card>header{display:flex;justify-content:space-between;align-items:center;background:#131939;padding:12px 14px;border-bottom:1px solid #223059}
  .card>header h2{margin:0;font-size:18px}
  .body{padding:14px;display:grid;gap:10px}
  .out{background:#0b0f24;border:1px dashed #2a355d;border-radius:12px;padding:10px;min-height:44px}
  .code{font-family:ui-monospace,SFMono-Regular,Consolas,Menlo,monospace;background:#0b0f24;border:1px solid #2a355d;border-radius:12px;padding:10px;overflow:auto}
  details summary{cursor:pointer;user-select:none}
  footer{padding:24px;text-align:center;color:var(--sub)}
  .cols{display:grid;grid-template-columns:1.2fr .8fr;gap:12px}
  @media (max-width:900px){.cols{grid-template-columns:1fr}}
  .hudbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;justify-content:center;margin-top:10px}
  .sep{border:none;border-top:1px solid #23325e;margin:4px 0}
</style>
</head>
<body>
<header>
  <h1>ğŸ” é«˜æ ¡ç”Ÿå‘ã‘ãƒ»ãƒãƒƒã‚­ãƒ³ã‚°ä½“é¨“ãƒ©ãƒœ</h1>
  <p>â€œæ“¬ä¼¼ã‚µã‚¤ãƒˆâ€ã§10ç¨®ã®è„†å¼±æ€§ã‚’å®‰å…¨ã«æ”»ç•¥ã€‚ãƒ’ãƒ³ãƒˆâ†’å®Ÿè·µâ†’è‡ªå‹•åˆ¤å®šã§å­¦ã¹ã¾ã™ã€‚</p>
  <p class="sub" style="font-size:12px">â€» ã“ã®æ•™æã¯<strong>å­¦ç¿’å°‚ç”¨</strong>ã§ã™ã€‚å®Ÿã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã™ã‚‹æ”»æ’ƒè¡Œç‚ºã¯çµ¶å¯¾ã«è¡Œã‚ãªã„ã“ã¨ã€‚</p>
</header>

<main id="app"></main>

<footer>Â© ã‚¨ã‚·ã‚«ãƒ«ãƒãƒƒã‚­ãƒ³ã‚°å­¦ç¿’ç”¨ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³: classroom-missions (no-score)</footer>

<script>
/* ========= ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ========= */
const $ = s => document.querySelector(s);
const el = (tag, attrs={}, children=[])=>{
  const n=document.createElement(tag);
  for(const[k,v] of Object.entries(attrs)){
    if(k==='class') n.className=v;
    else if(k.startsWith('on') && typeof v==='function') n.addEventListener(k.slice(2),v);
    else n.setAttribute(k,v);
  }
  (Array.isArray(children)?children:[children]).forEach(c=>n.append(c instanceof Node?c:document.createTextNode(c)));
  return n;
};
const sanitize = (s)=>{const d=document.createElement('div'); d.innerText=s; return d.innerHTML;};
const storage = {
  get(k,def){ try{ return JSON.parse(localStorage.getItem(k)) ?? def }catch{ return def } },
  set(k,v){ try{ localStorage.setItem(k,JSON.stringify(v)) }catch{} }
};
const rand = () => Math.random().toString(36).slice(2);

/* ========= ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ / é€²æ—ã®ã¿ï¼ˆã‚¹ã‚³ã‚¢ãªã—ï¼‰ ========= */
const LAB_KEY = "hs_lab_progress_v1_noscore";
const state = storage.get(LAB_KEY, {
  player: null,         // {name, id}
  solved: {},           // {missionId: true}
  startedAt: Date.now()
});
function save(){ storage.set(LAB_KEY, state); }
function ensurePlayerUI(container){
  const row = el('div',{class:'row'},[
    el('input',{id:'playerName',placeholder:'ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ï¼ˆä¾‹: ãŸã‚ã†ï¼‰',value:state.player?.name||''}),
    el('button',{class:'btn',onclick:()=>{
      const name = $('#playerName').value.trim().slice(0,20)||`player_${rand().slice(0,4)}`;
      state.player = {name, id: state.player?.id || rand()};
      save(); renderHud();
    }},["å‚åŠ  / æ›´æ–°"]),
    el('button',{class:'btn-ghost',onclick:()=>{localStorage.removeItem(LAB_KEY); location.reload();}},["ãƒªã‚»ãƒƒãƒˆ"])
  ]);
  container.append(row);
}
function markSolved(id){
  if(!state.solved[id]){
    state.solved[id]=true;
    save();
    renderHud();
    const tag = document.querySelector(`#m${id} header .sub`);
    if(tag) tag.textContent = "âœ… ã‚¯ãƒªã‚¢æ¸ˆ";
  }
}
function renderHud(){
  const hud = $("#hud");
  if(!hud) return;
  hud.innerHTML="";
  const total = 10;
  const solvedCount = Object.keys(state.solved).length;
  hud.append(
    el('div',{class:'hudbar'},[
      el('span',{class:'pill'},["ğŸ‘¤ ", state.player?.name || "æœªå‚åŠ "]),
      el('span',{class:'pill'},[`âœ… ã‚¯ãƒªã‚¢: ${solvedCount}/${total}`]),
      el('button',{class:'btn-ghost',onclick:()=>alert(
        "éŠã³æ–¹ï¼š\n1) ç›®çš„ã‚’èª­ã‚“ã§â€œæ“¬ä¼¼ã‚µã‚¤ãƒˆâ€ã‚’æ“ä½œ\n2) æ¡ä»¶ã‚’æº€ãŸã™ã¨è‡ªå‹•ã§ã‚¯ãƒªã‚¢ï¼ˆãƒãƒƒã‚¸è¡¨ç¤ºï¼‰\n3) ãƒ’ãƒ³ãƒˆã¯æ®µéšå¼ï¼ˆæ¸›ç‚¹è¦ç´ ãªã—ï¼‰"
      )},["â„¹ï¸ éŠã³æ–¹"])
    ])
  );
}

/* ========= å…±é€š: ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚«ãƒ¼ãƒ‰ï¼ˆç‚¹æ•°è¡¨ç¤ºãªã—ï¼‰ ========= */
function missionCard(id, title, build){
  const card = el('section',{class:'card', id:`m${id}`},[
    el('header',{},[
      el('h2',{},[`${id}. ${title}`]),
      el('div',{},[
        el('span',{class:'pill sub'},[ state.solved[id] ? "âœ… ã‚¯ãƒªã‚¢æ¸ˆ" : "æœªã‚¯ãƒªã‚¢" ])
      ])
    ]),
    el('div',{class:'body'})
  ]);
  build(card.querySelector('.body'), ()=>markSolved(id));
  return card;
}

/* ========= å„ãƒŸãƒƒã‚·ãƒ§ãƒ³ ========= */
const app = $("#app");

/* HUD + å‚åŠ  */
app.append(el('section',{class:'card'},[
  el('header',{},[ el('h2',{},["âš™ï¸ å‚åŠ è¨­å®šãƒ»é€²æ—"]), el('span',{id:'hud'}) ]),
  el('div',{class:'body'},[
    (()=>{
      const c = el('div',{}); ensurePlayerUI(c); return c;
    })()
  ])
]));
renderHud();

/* M1: Reflected XSS ã‚’èµ·ã“ã›ï¼ˆã‚¢ãƒ©ãƒ¼ãƒˆã‚’å‡ºã™ï¼‰ */
app.append(missionCard(1,"Reflected XSSï¼šã‚¢ãƒ©ãƒ¼ãƒˆã‚’å‡ºãã†",(body, solved)=>{
  const input = el('input',{placeholder:"ä¾‹:"});
  const show  = el('button',{class:'btn'},["è¡¨ç¤º"]);
  const out   = el('div',{class:'out'},"ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™");
  show.onclick = ()=>{
    out.innerHTML = "ã‚ãªãŸã®å…¥åŠ›: " + input.value; // ã‚ã–ã¨è„†å¼±
    if(out.querySelector("script")) { solved(); alert("ğŸ‰ ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¯ãƒªã‚¢ï¼ï¼ˆåå°„XSSï¼‰"); }
  };
  body.append(
    el('p',{},["ç›®çš„ï¼šå…¥åŠ›ã‚’ãã®ã¾ã¾è¡¨ç¤ºã™ã‚‹æ¬„ã§ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã•ã›ã‚‹ã€‚"]),
    el('div',{class:'row'},[input,show]),
    out,
    el('details',{},[
      el('summary',{},["ãƒ’ãƒ³ãƒˆ"]),
      el('div',{},[
        el('br'), "ãƒ’ãƒ³ãƒˆï¼šimg ã® onerror ãªã©ã§ã‚‚å¯èƒ½ï¼ˆä¾‹ï¼š", el('span',{class:'code'},["<img src=x >"]), "ï¼‰ã€‚"
      ])
    ])
  );
}));

/* M2: Stored XSS ã‚’ç™ºç”Ÿã•ã›ã‚‹ï¼ˆæ“¬ä¼¼DB: localStorageï¼‰ */
app.append(missionCard(2,"Stored XSSï¼šä¿å­˜ã—ãŸæŠ•ç¨¿ã§å®Ÿè¡Œ",(body, solved)=>{
  const ta = el('textarea',{placeholder:"ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿ï¼ˆä¾‹: <img src=x onerror=alert('hi')>ï¼‰"});
  const saveBtn = el('button',{class:'btn'},["æŠ•ç¨¿"]);
  const list = el('div',{class:'out'});
  function render(){
    const items = storage.get("m2_comments",[]);
    list.innerHTML="";
    items.forEach(html=>{
      const item = el('div',{class:'code'});
      item.innerHTML = html; // ã‚ã–ã¨è„†å¼±
      list.append(item);
      if(item.querySelector("script") || item.querySelector("[onerror],[onload]")){
        solved();
      }
    });
  }
  saveBtn.onclick = ()=>{
    const items = storage.get("m2_comments",[]);
    items.push(ta.value);
    storage.set("m2_comments",items);
    ta.value=''; render();
  };
  body.append(
    el('p',{},["ç›®çš„ï¼šä¿å­˜æ¸ˆã¿ã®æŠ•ç¨¿ã‚’è¡¨ç¤ºã—ãŸã¨ãã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå‹•ã‘ã°æˆåŠŸã€‚"]),
    ta, el('div',{class:'row'},[saveBtn, el('button',{class:'btn-ghost',onclick:()=>{localStorage.removeItem("m2_comments"); render();}},["å…¨å‰Šé™¤"])]),
    list,
    el('details',{},[
      el('summary',{},["ãƒ’ãƒ³ãƒˆ"]),
      "ãƒ’ãƒ³ãƒˆï¼šimg ã®ã‚¨ãƒ©ãƒ¼æ™‚ãƒãƒ³ãƒ‰ãƒ©ï¼ˆonerrorï¼‰ã«æ³¨ç›®ã€‚"
    ])
  ); render();
}));

/* M3: DOM XSSï¼ˆURLãƒãƒƒã‚·ãƒ¥ # ç”±æ¥ï¼‰ */
app.append(missionCard(3,"DOM XSSï¼šURLãƒãƒƒã‚·ãƒ¥ã§æ”¹ã–ã‚“",(body, solved)=>{
  const out = el('div',{class:'out'},"URLã® # ä»¥é™ãŒãã®ã¾ã¾ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚");
  async function copySample() {
    const sample = location.origin + location.pathname + "#<img src=x onerror=alert('dom')>";
    try {
      await navigator.clipboard.writeText(sample);
      alert("ã‚µãƒ³ãƒ—ãƒ«URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹æ¬„ã«è²¼ã£ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã‚ˆã†ã€‚");
    } catch {
      prompt("ã“ã®URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä½¿ã£ã¦ãã ã•ã„ğŸ‘‡", sample);
    }
  }
  function apply(){
    const raw = decodeURIComponent(location.hash.slice(1));
    out.innerHTML = raw || "ï¼ˆãƒãƒƒã‚·ãƒ¥ãªã—ï¼‰"; // ã‚ã–ã¨è„†å¼±
    if(out.querySelector("script") || out.querySelector("[onerror],[onload]")) solved();
  }
  const copyLink = el('button',{class:'btn-ghost',onclick:copySample},["ã‚µãƒ³ãƒ—ãƒ«URLã‚’ã‚³ãƒ”ãƒ¼"]);
  window.addEventListener('hashchange',apply);
  body.append(el('p',{},["ç›®çš„ï¼š# ã®å¾Œã‚ã«ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’å…¥ã‚Œã¦é·ç§»ã—ã€è¡¨ç¤ºé ˜åŸŸã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œã‚’ç‹™ã†ã€‚"]), copyLink, out);
  apply();
}));

/* M4: HTMLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆè¦‹å‡ºã—ã‚’å‹æ‰‹ã«è¿½åŠ ï¼‰ */
app.append(missionCard(4,"HTMLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼šUIæ”¹ã–ã‚“",(body, solved)=>{
  const input = el('input',{placeholder:"ä¾‹: <h3 style='color:gold'>å‹æ‰‹ãªè¦‹å‡ºã—</h3>"});
  const prev = el('button',{class:'btn'},["ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼"]);
  const area = el('div',{class:'out'});
  prev.onclick = ()=>{
    area.innerHTML = input.value; // ã‚ã–ã¨è„†å¼±
    if(area.querySelector("h1,h2,h3,h4,h5,h6")) solved();
  };
  body.append(
    el('p',{},["ç›®çš„ï¼šä»»æ„ã®è¦‹å‡ºã—ã‚„ãƒœã‚¿ãƒ³ã‚’åŸ‹ã‚è¾¼ã¿ã€è¦‹ãŸç›®ã‚’æ”¹ã–ã‚“ã§ããŸã‚‰æˆåŠŸã€‚"]),
    el('div',{class:'row'},[input,prev]),
    area
  );
}));

/* M5: SQL Injectionï¼ˆè¶…ç°¡æ˜“ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ï¼‰ */
app.append(missionCard(5,"SQLiï¼š' OR '1'='1 ã§å…¨ä»¶å–å¾—",(body, solved)=>{
  const users = [
    {id:1, name:"Taro", username:"taro"},
    {id:2, name:"Hanako", username:"hanako"},
    {id:3, name:"Ichiro", username:"ichiro"}
  ];
  const q = el('input',{placeholder:"ä¾‹: ' OR '1'='1"});
  const btn = el('button',{class:'btn'},["æ¤œç´¢"]);
  const out = el('div',{class:'out'});
  btn.onclick = ()=>{
    const term = q.value;
    // ã‚ã–ã¨è„†å¼±ï¼šç–‘ä¼¼SQLé€£çµãƒ­ã‚¸ãƒƒã‚¯
    const all = /'?\s*OR\s*'1'\s*=\s*'1/i.test(term);
    const res = all ? users : users.filter(u=> (u.username+u.name).toLowerCase().includes(term.toLowerCase()));
    out.innerHTML = res.map(u=>`<span class="pill">#${u.id} ${sanitize(u.name)} (@${sanitize(u.username)})</span>`).join(" ");
    if(all) solved();
  };
  body.append(
    el('p',{},["ç›®çš„ï¼šæ¡ä»¶ã‚’çœŸã«ã—ã¦å…¨ä»¶ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚"]),
    el('div',{class:'row'},[q,btn]), out,
    el('details',{},[el('summary',{},["ãƒ’ãƒ³ãƒˆ"]), "ãƒ’ãƒ³ãƒˆï¼š", el('span',{class:'code'},["' OR '1'='1"])])
  );
}));

/* M6: CSRFï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ãªã—é€é‡‘ã‚’æˆç«‹ã•ã›ã‚‹ï¼‰ */
app.append(missionCard(6,"CSRFï¼šå¤–éƒ¨æ“ä½œã§é€é‡‘",(body, solved)=>{
  let balance = storage.get("m6_balance", 10000);
  function saveBal(){ storage.set("m6_balance", balance); bal.textContent = `å£åº§æ®‹é«˜: Â¥${balance.toLocaleString()}`; }
  const bal = el('div',{class:'out'});
  const normal = el('button',{class:'btn'},["æ­£è¦ï¼šÂ¥500 å¯„ä»˜"]);
  const attacker = el('button',{class:'btn-bad'},["æ”»æ’ƒãƒšãƒ¼ã‚¸ï¼šã“ã£ãã‚Šé€é‡‘"]);
  normal.onclick = ()=>{ balance -= 500; saveBal(); };
  attacker.onclick = ()=>{ balance -= 500; saveBal(); solved(); alert("ğŸ‰ é€é‡‘ãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ãªã—ï¼‰ã€‚"); };
  body.append(el('p',{},["ç›®çš„ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ„æ€ã«åã—ã¦é€é‡‘ã‚’æˆç«‹ã•ã›ã‚‹ï¼ˆç–‘ä¼¼å‹•ä½œï¼‰ã€‚"]), bal, el('div',{class:'row'},[normal,attacker]),
    el('details',{},[el('summary',{},["ãƒ’ãƒ³ãƒˆ"]), "ãƒ’ãƒ³ãƒˆï¼šimgã‚¿ã‚°ã‚„ãƒªãƒ³ã‚¯è¸ã¿ãªã©ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã«è¦‹ã›ã‹ã‘ãŸè‡ªå‹•é€ä¿¡ã‚’æƒ³åƒã—ã¦ã¿ã‚ˆã†ã€‚"])
  );
  saveBal();
}));

/* M7: ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°ï¼ˆé€æ˜UIã§èª¤ã‚¯ãƒªãƒƒã‚¯ï¼‰ */
app.append(missionCard(7,"ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°ï¼šéš ã—ãƒœã‚¿ãƒ³ã‚’æŠ¼ã•ã›ã‚‹",(body, solved)=>{
  const box = el('div',{class:'out',style:"position:relative;height:140px"});
  const bait = el('button',{style:"position:absolute;left:12px;top:12px"},["è¦‹ãŸç›®ã®ãƒœã‚¿ãƒ³"]);
  const hidden = el('button',{style:"position:absolute;left:48%;top:50%"},["ï¼ˆéš ã—ï¼‰æ‰¿èª"]);
  const overlay = el('a',{href:"#",style:"position:absolute;inset:0;opacity:.01"},["ã€€"]); // ã»ã¼è¦‹ãˆãªã„
  hidden.addEventListener('click',()=>{ solved(); alert("ğŸ‰ éš ã—ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚Œã¾ã—ãŸï¼"); });
  box.append(bait, hidden, overlay);
  body.append(
    el('p',{},["ç›®çš„ï¼šé€æ˜ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼è¶Šã—ã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¦‹ãˆãªã„æ“ä½œã‚’ã•ã›ã‚‹ä»•çµ„ã¿ã‚’ä½“é¨“ã€‚"]),
    box
  );
}));

/* M8: ã‚ªãƒ¼ãƒ—ãƒ³ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼ˆä»»æ„URLã¸é·ç§»ã•ã›ã‚‹ï¼‰ */
app.append(missionCard(8,"ã‚ªãƒ¼ãƒ—ãƒ³ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼šä»»æ„ã‚µã‚¤ãƒˆã¸é£›ã°ã™",(body, solved)=>{
  const input = el('input',{placeholder:"ä¾‹: https://example.org/phish"});
  const go = el('button',{class:'btn'},["ç§»å‹•"]);
  go.onclick = ()=>{
    const u = input.value.trim();
    if(!u) return;
    // ã‚ã–ã¨è„†å¼±ï¼šãƒ›ã‚¹ãƒˆåã®æ¤œè¨¼ãªã—ï¼ˆå®Ÿéš›ã®é·ç§»ã¯è¡Œã‚ãªã„ï¼‰
    try{ new URL(u); }catch{ return alert("URLãŒä¸æ­£"); }
    solved();
    alert("ğŸ‰ ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¯ãƒªã‚¢ï¼ï¼ˆå®Ÿéš›ã®é·ç§»ã¯è¡Œã„ã¾ã›ã‚“ï¼‰");
  };
  body.append(
    el('p',{},["ç›®çš„ï¼šè‡ªç”±å…¥åŠ›ã‚’ä½¿ã£ã¦ã€ä»»æ„ã®å¤–éƒ¨URLã¸é·ç§»ã§ãã‚‹çŠ¶æ³ã‚’å†ç¾ã™ã‚‹ã€‚"]),
    el('div',{class:'row'},[input,go]),
    el('div',{class:'sub'},["â€» å®‰å…¨é¢ã®éƒ½åˆã§å®Ÿé·ç§»ã¯ã—ãªã„å®Ÿè£…ã§ã™ã€‚"])
  );
}));

/* M9: IDORï¼ˆä»–äººã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’å–å¾—ï¼‰ */
app.append(missionCard(9,"IDORï¼šä»–äººã®æƒ…å ±ã‚’è¦‹ã¦ã—ã¾ã†",(body, solved)=>{
  const users = [
    {id:1, name:"Taro", secret:"ğŸ°å¥½ã"},
    {id:2, name:"Hanako", secret:"ğŸ“šå¥½ã"},
    {id:3, name:"Ichiro", secret:"âš½ï¸å¥½ã"}
  ];
  const login = users[0]; // Taroã§ãƒ­ã‚°ã‚¤ãƒ³ä¸­
  const input = el('input',{type:'number',min:1,placeholder:"ãƒ¦ãƒ¼ã‚¶ãƒ¼IDï¼ˆä¾‹: 2ï¼‰"});
  const btn = el('button',{class:'btn'},["å–å¾—"]);
  const out = el('div',{class:'out'});
  btn.onclick = ()=>{
    const id = Number(input.value);
    const target = users.find(u=>u.id===id);
    if(!target) { out.textContent="è©²å½“ãªã—"; return; }
    // ã‚ã–ã¨è„†å¼±ï¼šèªå¯ãƒã‚§ãƒƒã‚¯ã—ãªã„
    out.textContent = `é–²è¦§ä¸­: ${target.name} (${target.secret})`;
    if(id !== login.id) solved();
  };
  body.append(
    el('p',{},["ç›®çš„ï¼šè‡ªåˆ†ä»¥å¤–ã®IDã‚’æŒ‡å®šã—ã¦ã€æƒ…å ±ãŒè¦‹ãˆã¦ã—ã¾ã†çŠ¶æ…‹ã‚’å†ç¾ã€‚"]),
    el('div',{class:'row'},[input,btn]),
    out
  );
}));

/* M10: ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¤œè¨¼ä¸å‚™ï¼ˆæ‹¡å¼µå­å½è£…ï¼‰ */
app.append(missionCard(10,"ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¤œè¨¼ï¼šæ‹¡å¼µå­å½è£…ã‚’é€šã™",(body, solved)=>{
  const inp = el('input',{type:'file'});
  const out = el('div',{class:'out'},"æ‹¡å¼µå­ã ã‘ã§åˆ¤å®šã™ã‚‹æ“¬ä¼¼ã‚µãƒ¼ãƒã€‚");
  inp.addEventListener('change',()=>{
    const f = inp.files?.[0];
    if(!f) return;
    // ã‚ã–ã¨è„†å¼±ï¼šæ‹¡å¼µå­ã ã‘ã‚’è¦‹ã‚‹
    const ok = /\.(png|jpg|jpeg|gif)$/i.test(f.name);
    out.textContent = ok ? `âœ… å—ç†: ${f.name}` : `âŒ æ‹’å¦: ${f.name}`;
    if(ok && /\.php|\.exe|\.html/i.test(f.name.replace(/\.(png|jpg|jpeg|gif)$/i,''))){
      // ä¾‹: attack.php.jpg â†’ å—ç†ã•ã‚Œã¦ã—ã¾ã£ãŸã‚‰æˆåŠŸæ‰±ã„
      solved(); alert("ğŸ‰ ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¯ãƒªã‚¢ï¼ï¼ˆå½è£…æ‹¡å¼µå­ãŒé€šã£ã¦ã—ã¾ã£ãŸï¼‰");
    }
  });
  body.append(
    el('p',{},["ç›®çš„ï¼š", el('span',{class:'code'},["attack.php.jpg"]), " ã®ã‚ˆã†ãªåå‰ã§â€œé€šéâ€ã•ã›ã‚‹ä½“é¨“ã‚’ã™ã‚‹ï¼ˆâ€»å®Ÿãƒ•ã‚¡ã‚¤ãƒ«ã¯é€ä¿¡ã—ã¾ã›ã‚“ï¼‰ã€‚"]),
    inp, out
  );
}));

/* ========= å­¦ç¿’ã®ã¾ã¨ã‚ ========= */
app.append(el('section',{class:'card'},[
  el('header',{},[el('h2',{},["ğŸ“š å­¦ã³ã®ãƒã‚¤ãƒ³ãƒˆã¾ã¨ã‚"]), el('span',{class:'pill'},["OWASP Top 10 ã«æ¥ç¶š"]) ]),
  el('div',{class:'body cols'},[
    el('div',{},[
      el('p',{},["ãƒ»XSSï¼šinnerHTMLã«å…¥ã‚Œãªã„ã€‚ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ»CSPã€‚"]),
      el('p',{},["ãƒ»SQLiï¼šæ–‡å­—åˆ—é€£çµç¦æ­¢ã€å¿…ãšãƒ—ãƒªãƒšã‚¢ãƒ‰ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã€‚"]),
      el('p',{},["ãƒ»CSRFï¼šCSRFãƒˆãƒ¼ã‚¯ãƒ³ã€SameSite Cookieã€ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã€‚"]),
      el('p',{},["ãƒ»Clickjackingï¼š", el('span',{class:'code'},["X-Frame-Options, frame-ancestors"]), "ã€‚"]),
      el('p',{},["ãƒ»Open Redirectï¼šç›¸å¯¾ãƒ‘ã‚¹/è¨±å¯ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã¿ã«é™å®šã€‚"]),
      el('p',{},["ãƒ»IDORï¼šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‚ç…§ã®å‰ã«èªå¯ãƒã‚§ãƒƒã‚¯ã€‚"]),
      el('p',{},["ãƒ»Uploadï¼šMIME/ã‚·ã‚°ãƒãƒãƒ£æ¤œæŸ»ã€å†ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã€å®Ÿè¡Œä¸å¯é ˜åŸŸã¸ä¿å­˜ã€‚"])
    ]),
    el('div',{},[
      el('p',{class:'sub'},["æˆæ¥­ã§ã®ä½¿ã„æ–¹ï¼š"]),
      el('p',{},["1) 10ã€œ15åˆ† è‡ªç”±æ”»ç•¥ â†’ 2) 5åˆ† ãµã‚Šã‹ãˆã‚Šã‚¹ã‚¯ã‚·ãƒ§ â†’ 3) 15åˆ† å¯¾ç­–ã‚³ãƒ¼ãƒ‰ä¾‹ç´¹ä»‹ â†’ 4) 5åˆ† å°ãƒ†ã‚¹ãƒˆ"]),
      el('p',{},["å…ˆç”Ÿç”¨ï¼šé€²æ—ã¯ãƒãƒƒã‚¸è¡¨ç¤ºã®ã¿ï¼ˆã‚¹ã‚³ã‚¢ãªã—ï¼‰ã€‚"])
    ])
  ])
]));

/* åˆæœŸãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° */
renderHud();
</script>
</body>
</html>
